<div class="products-container">
  <div class="breadcrumb">
    <ul class="breadcrumb-list">
      <li class="breadcrumb-item"><a routerLink="/">Inicio</a></li>
      <li class="breadcrumb-item active">Productos</li>
    </ul>
  </div>

  <div class="products-header">
    <div class="title-row">
      <h2 class="section-title">Gestión de Productos</h2>
      <button class="btn create-product-header" (click)="openCreate()">
        <i class="bi bi-plus-lg"></i> Crear producto
      </button>
   </div>

    <div class="header-controls">
      <div class="view-toggle">
        <button class="view-btn" [class.active]="viewMode === 'grid'" (click)="setView('grid')">
          <i class="bi bi-grid"></i>
        </button>
        <button class="view-btn" [class.active]="viewMode === 'list'" (click)="setView('list')">
          <i class="bi bi-list"></i>
        </button>
      </div>
    </div>
  </div>

  <div class="search-results">
    <div class="results-header">
      <div class="results-count">{{ productos.length }} productos</div>
      <div class="sort-options">
        <select [(ngModel)]="sortOption" (change)="sortProducts()">
          <option value="price-asc">Precio: Menor a Mayor</option>
          <option value="price-desc">Precio: Mayor a Menor</option>
          <option value="name-asc">Nombre: A-Z</option>
          <option value="name-desc">Nombre: Z-A</option>
        </select>
      </div>
    </div>
  </div>

  <div [ngClass]="{'products-grid': viewMode === 'grid', 'products-list': viewMode === 'list'}">
    <div *ngFor="let producto of productos" class="product-card product-item">
      <div class="product-image">
        <img [src]="producto.imagen" [alt]="producto.nombre" />
      </div>

      <div class="product-info">
        <div class="product-category">{{ producto.categoria }}</div>
        <h3 class="product-title">{{ producto.nombre }}</h3>
        <p class="product-description">{{ producto.descripcion }}</p>

        <div class="product-meta">
          <div class="product-price">
            <span class="current-price">${{ producto.precio | number:'1.0-0' }}</span>
          </div>
          <div class="product-stock">
            Stock: <strong>{{ producto.stock ?? producto.cantidad ?? 0 }}</strong>
          </div>
        </div>

        <div class="product-actions admin-actions">
          <button class="btn btn-edit" (click)="openEdit(producto)">
            <i class="bi bi-pencil"></i> Editar
          </button>
          <button class="btn btn-delete" (click)="openDelete(producto)">
            <i class="bi bi-trash"></i> Eliminar
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Editar / Crear -->
<div class="modal-backdrop" *ngIf="showEditModal">
  <div class="modal" role="dialog" aria-modal="true">
    <header class="modal-header">
      <h3>{{ selectedProduct ? 'Editar Producto' : 'Crear Producto' }}</h3>
      <button class="close-btn" (click)="closeEdit()">&times;</button>
    </header>
    <section class="modal-body">
      <app-product-form [product]="selectedProduct" (saved)="onProductSaved($event)"></app-product-form>
    </section>
    <footer class="modal-footer">
      <button class="btn btn-secondary" (click)="closeEdit()">Cancelar</button>
    </footer>
  </div>
</div>

<!-- Modal Eliminar -->
<div class="modal-backdrop" *ngIf="showDeleteModal">
  <div class="modal small" role="dialog" aria-modal="true">
    <header class="modal-header">
      <h3>Confirmar Eliminación</h3>
      <button class="close-btn" (click)="closeDelete()">&times;</button>
    </header>
    <section class="modal-body">
      ¿Seguro que quieres eliminar <strong>{{ selectedProduct?.nombre }}</strong>?
    </section>
    <footer class="modal-footer">
      <button class="btn btn-danger" (click)="confirmDelete()">Eliminar</button>
      <button class="btn btn-secondary" (click)="closeDelete()">Cancelar</button>
    </footer>
  </div>
</div>
